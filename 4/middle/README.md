# Лабораторная работа 4 — BUY (Middle)

Веб-приложение по типу Куфар: объявления, поиск, регистрация, JWT. Spring Boot, Spring Security, Spring Data JPA (Hibernate), PostgreSQL.

## Запуск

Локально: создать БД `lab4middle` в PostgreSQL и задать переменные `DB_HOST`, `DB_PORT`, `DB_NAME`, `DB_USER`, `DB_PASSWORD`. Затем `mvn spring-boot:run`.

Docker: из корня проекта `docker compose up --build app5`. Приложение: http://localhost:8084

Если приложение падает с ошибкой подключения к БД (Could not obtain connection), база lab4middle ещё не создана. Создать один раз:
`docker compose exec db psql -U lab2 -d postgres -c "CREATE DATABASE lab4middle;"`
Затем перезапустить: `docker compose up -d app5`.

## Хранение изображений

Фотографии товаров и аватар пользователя хранятся в БД в виде Base64 (поля `profile_photo_base64`, `photo1_base64`, `photo2_base64`, `photo3_base64` в таблицах `users` и `listings`). Это плохая практика: раздувает БД, замедляет выборки и бэкапы, усложняет кэширование и CDN. Используется только как быстрый способ без файлового хранилища. В проде рекомендуется хранить файлы в файловой системе или S3 и в БД держать только URL или путь.

## Функционал

- Регистрация и вход (JWT в cookie).
- Поиск объявлений по ключевым словам и городу.
- Просмотр объявления и переход к продавцу.
- Личный кабинет: просмотр и редактирование профиля, загрузка фото.
- Мои товары: добавление объявления (название, цена, город, описание, до 3 фото).
